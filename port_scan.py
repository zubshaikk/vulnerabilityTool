import nmap

def scan_ports(target_ips, specific_ip=None):
    nm = nmap.PortScanner()
    scanned_results = {}
    if specific_ip:
        target_ips = [specific_ip]

    for ip in target_ips:
        nm.scan(ip, '1-1024', '-Pn -T4')
        services = []
        for protocol in nm[ip].all_protocols():
            lport = nm[ip][protocol].keys()
            for port in lport:
                service = nm[ip][protocol][port]['name']
                services.append(service)
        scanned_results[ip] = services
    return scanned_results
