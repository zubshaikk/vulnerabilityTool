from network_discovery import discover_network
from port_scan import scan_ports
from vul_assess import check_vulnerabilities

def main():
    target_subnet = input("Enter the target subnet (e.g., 192.168.1.0/24): ")
    discovered_ips = discover_network(target_subnet)
    print(f"Discovered IPs: {discovered_ips}")
    
    action = input("Do you want to scan all IPs or a specific one? (all/specific): ").strip().lower()
    specific_ip = None
    if action == "specific":
        specific_ip = input("Enter the IP address to scan: ").strip()
    
    scanned_ports = scan_ports(discovered_ips, specific_ip)
    for ip in scanned_ports:
        print(f"Scanned Ports for {ip}: {scanned_ports[ip]}")


    for ip, services in scanned_ports.items():
        print(f"\nChecking for vulnerabilities on {ip}:")
        vulnerabilities = check_vulnerabilities(services)
        for service, vulnerability in vulnerabilities.items():
            print(f"{service}: {vulnerability}")

if __name__ == "__main__":
    main()
